<mxfile host="Electron" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/28.1.2 Chrome/138.0.7204.243 Electron/37.4.0 Safari/537.36" version="28.1.2">
  <diagram name="AWS Architecture" id="aws-architecture">
    <mxGraphModel dx="1213" dy="828" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" value="テストケース自動手順生成システム AWS構成図" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="400" y="20" width="400" height="30" as="geometry" />
        </mxCell>
        <mxCell id="legend" value="凡例" style="rounded=1;whiteSpace=wrap;html=1;fontSize=14;fontStyle=1;fillColor=#f8cecc;strokeColor=#b85450;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="50" y="70" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="legend-mvp" value="MVP段階(社内限定)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#e1f5fe;strokeColor=#006064;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="50" y="110" width="120" height="25" as="geometry" />
        </mxCell>
        <mxCell id="legend-phase2" value="Phase 2(外部公開)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#fff3e0;strokeColor=#e65100;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="50" y="145" width="120" height="25" as="geometry" />
        </mxCell>
        <mxCell id="users-group" value="ユーザー" style="rounded=1;whiteSpace=wrap;html=1;fontSize=14;fontStyle=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="50" y="200" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="user-internal" value="社内ユーザー&#xa;(MVP Phase)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=11;fillColor=#e1f5fe;strokeColor=#006064;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="50" y="260" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="user-external" value="外部ユーザー&#xa;(Phase 2)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=11;fillColor=#fff3e0;strokeColor=#e65100;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="50" y="330" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="corp-network" value="社内ネットワーク&#xa;192.168.0.0/16&#xa;10.0.0.0/8" style="rounded=1;whiteSpace=wrap;html=1;fontSize=11;fillColor=#e1f5fe;strokeColor=#006064;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="200" y="240" width="120" height="70" as="geometry" />
        </mxCell>
        <mxCell id="internet" value="インターネット" style="rounded=1;whiteSpace=wrap;html=1;fontSize=11;fillColor=#fff3e0;strokeColor=#e65100;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="200" y="330" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="aws-cloud" value="AWS Cloud" style="rounded=1;whiteSpace=wrap;html=1;fontSize=16;fontStyle=1;fillColor=#fff2cc;strokeColor=#d6b656;verticalAlign=top;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="380" y="120" width="860" height="650" as="geometry" />
        </mxCell>
        <mxCell id="waf" value="AWS WAF&#xa;(Phase 2)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=11;fillColor=#fff3e0;strokeColor=#e65100;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="400" y="160" width="80" height="50" as="geometry" />
        </mxCell>
        <mxCell id="acm" value="AWS ACM&#xa;TLS証明書&#xa;(Phase 2)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#fff3e0;strokeColor=#e65100;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="500" y="160" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="vpc" value="VPC" style="rounded=1;whiteSpace=wrap;html=1;fontSize=14;fontStyle=1;fillColor=#e8f5e8;strokeColor=#2e7d32;verticalAlign=top;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="400" y="250" width="540" height="380" as="geometry" />
        </mxCell>
        <mxCell id="public-subnet" value="Public Subnets" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;fillColor=#f3e5f5;strokeColor=#7b1fa2;verticalAlign=top;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="420" y="280" width="200" height="80" as="geometry" />
        </mxCell>
        <mxCell id="alb" value="Application Load Balancer&#xa;MVP: HTTP:80&#xa;Phase2: HTTPS:443" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#e1f5fe;strokeColor=#006064;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="440" y="310" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="private-subnet" value="Private Subnets" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;fillColor=#f3e5f5;strokeColor=#7b1fa2;verticalAlign=top;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="420" y="380" width="500" height="200" as="geometry" />
        </mxCell>
        <mxCell id="ecs-cluster" value="ECS Cluster on EC2" style="rounded=1;whiteSpace=wrap;html=1;fontSize=11;fontStyle=1;fillColor=#e1f5fe;strokeColor=#006064;verticalAlign=top;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="440" y="410" width="460" height="150" as="geometry" />
        </mxCell>
        <mxCell id="ecs-task1" value="ECS Task 1" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#f3e5f5;strokeColor=#7b1fa2;verticalAlign=top;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="460" y="440" width="150" height="100" as="geometry" />
        </mxCell>
        <mxCell id="fastapi1" value="FastAPI&#xa;Port: 8000" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;fillColor=#e1f5fe;strokeColor=#006064;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="470" y="460" width="50" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ollama1" value="Ollama&#xa;Port: 11434&#xa;GPU" style="rounded=1;whiteSpace=wrap;html=1;fontSize=8;fillColor=#e1f5fe;strokeColor=#006064;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="555" y="460" width="45" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ecs-task2" value="ECS Task 2" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#f3e5f5;strokeColor=#7b1fa2;verticalAlign=top;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="620" y="440" width="150" height="100" as="geometry" />
        </mxCell>
        <mxCell id="fastapi2" value="FastAPI&#xa;Port: 8000" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;fillColor=#e1f5fe;strokeColor=#006064;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="630" y="460" width="45" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ollama2" value="Ollama&#xa;Port: 11434&#xa;GPU" style="rounded=1;whiteSpace=wrap;html=1;fontSize=8;fillColor=#e1f5fe;strokeColor=#006064;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="715" y="460" width="45" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ecs-taskN" value="ECS Task N&#xa;(Auto Scale)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=10;fillColor=#f3e5f5;strokeColor=#7b1fa2;verticalAlign=top;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="780" y="440" width="100" height="100" as="geometry" />
        </mxCell>
        <mxCell id="fastapIN" value="FastAPI" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;fillColor=#e1f5fe;strokeColor=#006064;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="790" y="480" width="35" height="25" as="geometry" />
        </mxCell>
        <mxCell id="ollamaN" value="Ollama&#xa;GPU" style="rounded=1;whiteSpace=wrap;html=1;fontSize=8;fillColor=#e1f5fe;strokeColor=#006064;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="835" y="480" width="35" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sg-container" value="Security Groups" style="rounded=1;whiteSpace=wrap;html=1;fontSize=11;fontStyle=1;fillColor=#ffebee;strokeColor=#c62828;verticalAlign=top;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="650" y="280" width="230" height="80" as="geometry" />
        </mxCell>
        <mxCell id="sg-alb" value="ALB SG&#xa;MVP: HTTP from 社内IP&#xa;Phase2: HTTPS from Internet" style="rounded=1;whiteSpace=wrap;html=1;fontSize=8;fillColor=#e1f5fe;strokeColor=#006064;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="660" y="305" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sg-ecs" value="ECS SG&#xa;HTTP:8000&#xa;from ALB only" style="rounded=1;whiteSpace=wrap;html=1;fontSize=8;fillColor=#e1f5fe;strokeColor=#006064;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="770" y="305" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aws-services" value="AWS Services" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;fillColor=#e8f5e8;strokeColor=#2e7d32;verticalAlign=top;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="1040" y="160" width="180" height="340" as="geometry" />
        </mxCell>
        <mxCell id="ecr" value="Amazon ECR&#xa;Container Registry&#xa;- FastAPI Image&#xa;- Ollama Image" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;fillColor=#e8f5e8;strokeColor=#2e7d32;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="1060" y="190" width="140" height="50" as="geometry" />
        </mxCell>
        <mxCell id="cloudwatch" value="CloudWatch Logs&#xa;- FastAPI: /aws/ecs/fastapi-app&#xa;- Ollama: /aws/ecs/ollama-server&#xa;- ALB: /aws/loadbalancer/app" style="rounded=1;whiteSpace=wrap;html=1;fontSize=8;fillColor=#e8f5e8;strokeColor=#2e7d32;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="1060" y="250" width="140" height="50" as="geometry" />
        </mxCell>
        <mxCell id="ssm" value="SSM Parameter Store&#xa;- Configuration&#xa;- Non-secret settings" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;fillColor=#e8f5e8;strokeColor=#2e7d32;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="1060" y="310" width="140" height="50" as="geometry" />
        </mxCell>
        <mxCell id="secrets" value="Secrets Manager&#xa;- API Keys&#xa;- Credentials" style="rounded=1;whiteSpace=wrap;html=1;fontSize=9;fillColor=#e8f5e8;strokeColor=#2e7d32;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="1060" y="370" width="140" height="50" as="geometry" />
        </mxCell>
        <mxCell id="ebs" value="EBS Volumes&#xa;- Ollama Models: /root/.ollama&#xa;- Persistent Storage&#xa;- GP3 (暗号化)" style="rounded=1;whiteSpace=wrap;html=1;fontSize=8;fillColor=#e8f5e8;strokeColor=#2e7d32;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="1060" y="430" width="140" height="50" as="geometry" />
        </mxCell>
        <mxCell id="iam-container" value="IAM" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;fillColor=#fff8e1;strokeColor=#ff8f00;verticalAlign=top;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="1040" y="530" width="180" height="120" as="geometry" />
        </mxCell>
        <mxCell id="iam-exec" value="ECS Task Execution Role&#xa;- ECR Pull権限&#xa;- CloudWatch Logs書込み" style="rounded=1;whiteSpace=wrap;html=1;fontSize=8;fillColor=#fff8e1;strokeColor=#ff8f00;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="1060" y="560" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="iam-task" value="ECS Task Role&#xa;- SSM/Secrets Manager読取り&#xa;- EBS Volume権限" style="rounded=1;whiteSpace=wrap;html=1;fontSize=8;fillColor=#fff8e1;strokeColor=#ff8f00;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="1060" y="600" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="conn1" style="endArrow=classic;html=1;fontSize=12;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#006064;" parent="1" source="user-internal" target="corp-network" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="150" y="285" as="sourcePoint" />
            <mxPoint x="200" y="235" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn2" style="endArrow=classic;html=1;fontSize=12;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#e65100;" parent="1" source="user-external" target="internet" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="150" y="355" as="sourcePoint" />
            <mxPoint x="200" y="305" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn3" style="endArrow=classic;html=1;fontSize=12;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#006064;" parent="1" source="corp-network" target="alb" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="320" y="275" as="sourcePoint" />
            <mxPoint x="370" y="225" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn4" style="endArrow=classic;html=1;fontSize=12;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=1;entryDx=0;entryDy=0;strokeColor=#e65100;" parent="1" source="internet" target="waf" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="320" y="355" as="sourcePoint" />
            <mxPoint x="370" y="305" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn5" style="endArrow=classic;html=1;fontSize=12;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#e65100;" parent="1" source="waf" target="alb" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="480" y="185" as="sourcePoint" />
            <mxPoint x="530" y="135" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn6" style="endArrow=classic;html=1;fontSize=12;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#006064;" parent="1" source="alb" target="fastapi1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="520" y="350" as="sourcePoint" />
            <mxPoint x="570" y="300" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn7" style="endArrow=classic;html=1;fontSize=12;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#006064;" parent="1" source="alb" target="fastapi2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="560" y="350" as="sourcePoint" />
            <mxPoint x="610" y="300" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn8" style="endArrow=classic;html=1;fontSize=12;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#7b1fa2;strokeWidth=2;dashed=1;" parent="1" source="fastapi1" target="ollama1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="515" y="475" as="sourcePoint" />
            <mxPoint x="565" y="425" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn9" style="endArrow=classic;html=1;fontSize=12;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#7b1fa2;strokeWidth=2;dashed=1;" parent="1" source="fastapi2" target="ollama2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="675" y="475" as="sourcePoint" />
            <mxPoint x="725" y="425" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn10" style="endArrow=classic;html=1;fontSize=12;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#2e7d32;" parent="1" source="fastapi1" target="ssm" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="515" y="460" as="sourcePoint" />
            <mxPoint x="565" y="410" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn11" style="endArrow=classic;html=1;fontSize=12;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#2e7d32;" parent="1" source="fastapi1" target="secrets" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="515" y="490" as="sourcePoint" />
            <mxPoint x="565" y="440" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn12" style="endArrow=classic;html=1;fontSize=12;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#2e7d32;strokeWidth=2;dashed=1;" parent="1" source="ebs" target="ollama1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="455" as="sourcePoint" />
            <mxPoint x="570" y="477" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn13" style="endArrow=classic;html=1;fontSize=12;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#2e7d32;strokeWidth=2;dashed=1;" parent="1" source="ebs" target="ollama2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="455" as="sourcePoint" />
            <mxPoint x="710" y="477" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn14" style="endArrow=classic;html=1;fontSize=12;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#2e7d32;strokeWidth=2;dashed=1;" parent="1" source="ebs" target="ollamaN" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="455" as="sourcePoint" />
            <mxPoint x="830" y="475" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="label1" value="localhost" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="520" y="460" width="35" height="15" as="geometry" />
        </mxCell>
        <mxCell id="label2" value="localhost" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="677.5" y="460" width="35" height="15" as="geometry" />
        </mxCell>
        <mxCell id="label3" value="/root/.ollama" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=7;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="970" y="389" width="60" height="12" as="geometry" />
        </mxCell>
        <mxCell id="phase-indicator" value="MVP段階: 青色のコンポーネント&#xa;Phase 2: オレンジ色のコンポーネント&#xa;EBS: Ollamaモデル永続化ストレージ" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="400" y="650" width="300" height="60" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
